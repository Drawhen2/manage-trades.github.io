<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scanner QRIS Pro</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        :root { --primary-color: #00ff88; }
        body { margin: 0; background: #000; font-family: sans-serif; color: white; height: 100vh; overflow: hidden; }
        #reader { width: 100%; height: 100%; }
        .ui-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; z-index: 10; pointer-events: none; }
        .scanner-frame { position: relative; width: 260px; height: 260px; margin-top: 150px; border: 2px solid rgba(255,255,255,0.2); }
        .laser-line { position: absolute; width: 100%; height: 3px; background: var(--primary-color); top: 0; animation: moveLaser 2s infinite ease-in-out; box-shadow: 0 0 15px var(--primary-color); }
        @keyframes moveLaser { 0%, 100% { top: 0%; } 50% { top: 100%; } }
        .error-msg { position: absolute; top: 20px; background: red; padding: 10px; border-radius: 5px; display: none; pointer-events: auto; }
    </style>
</head>
<body>

    <div id="error" class="error-msg"></div>
    <div id="reader"></div>

    <div class="ui-container">
        <div class="scanner-frame">
            <div class="laser-line"></div>
        </div>
        <p style="margin-top: 20px;">Arahkan Kamera ke QR Code</p>
    </div>

    <script>
        function onScanSuccess(decodedText) {
            console.log("Scan Berhasil:", decodedText);
            // Redirect jika mengandung kata pay.html
            if (decodedText.includes("pay.html")) {
                html5QrCode.stop().then(() => {
                    window.location.href = decodedText;
                });
            }
        }

        // Memulai Kamera Otomatis
        const html5QrCode = new Html5Qrcode("reader");
        const config = { fps: 15, qrbox: { width: 250, height: 250 } };

        // Memaksa kamera belakang (environment)
        html5QrCode.start({ facingMode: "environment" }, config, onScanSuccess)
        .catch(err => {
            const errDiv = document.getElementById('error');
            errDiv.style.display = 'block';
            errDiv.innerText = "Kamera Gagal Aktif: Gunakan HTTPS atau izinkan akses kamera.";
            console.error(err);
        });
    </script>
</body>
</html>
 
